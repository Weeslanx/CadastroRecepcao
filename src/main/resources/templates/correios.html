<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Entradas</title>
    <link rel="stylesheet" href="/styles.css">

 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
	
	<script src="https://cdn.jsdelivr.net/npm/sockjs-client/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs/lib/stomp.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
	 <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
	




</head>
<body>
    <div class="sidebar" id="sidebar">
        
        
        
         <div class="icon" data-tooltip="Entradas">
	        <a href="/registros/visitas">
	            <i class="fa fa-paper-plane"></i> 
	            <span>Registro de Entradas</span>
	        </a>
	    </div>
        
          <div class="icon" data-tooltip="finalizados">
	        <a href="/registros/visitas/finalizados">
	            <i class="fas fa-check-circle"></i> 
	            <span>Visitas Finalizadas</span>
	        </a>
	    </div>
        <div class="icon" data-tooltip="Configuração" onclick="window.location.href='/users/cadastroUsers'">
            <i class="fas fa-cog"></i>
            <span>Configuração</span>
        </div>
        <div class="sidebar-bottom-button">
            <form action="/users/logout" method="get">
                <button type="submit" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </form>
        </div>
        
        
        
     
	    
	   
    </div>
    
       <div class = "menu"> 
       
        <h1> Registro de Correios</h1>
        	
        	
								   <button class="add-visit" id="add-correios-btn">
                                    <i class="fas fa-plus"></i> Adicionar Correios	
								   </button>

						           
                                    
                                    <div class="logo-container">
                                        <img src="/images/logo3.png" alt="Logo" class="logo-img">
                                    </div>


                                    <button class="btn_dowload-correios" onclick="exportVisibleToCSV()">
                                        <i class="fas fa-download"></i>
                                    </button>
       </div>
     
       
    
    
       <div class="main-content">
        <div class="search-container">
            <input type="text" id="search-input" placeholder="Pesquisar" onkeyup="filter()">
        </div>

        

        <h2>Correios Cadastrados</h2>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Funcionário</th>
                    <th>Setor</th>
                    <th>Horário</th>
                    <th>Código Postal</th>
                    <th>Destinatário</th>
                    <th>Serviço</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="correio : ${Correios}">
                    <td th:text="${correio.id}"></td>
                    <td th:text="${correio.funcionario}"></td>
                    <td th:text="${correio.setor}"></td>
                    <td th:text="${#temporals.format(correio.horario, 'dd/MM/yyyy HH:mm')}"></td>

                    <td th:text="${correio.codigoPostal}"></td>
                    <td th:text="${correio.destinatario}"></td>
                    <td th:text="${correio.servico}"></td>
                </tr>
            </tbody>
        </table>
    </div>
    
    
            

    <div class="sidebar-right" id="sidebar-Correios" style="display: none;">
        <button class="close-btn" id="close-correios-btn">&times;</button>
        <h2>Cadastrar Correios</h2>
        <form action="/correios/cadastrar" method="POST">
            <label for="funcionario">Funcionário</label>
            <input type="text" id="funcionario" name="funcionario" required>

            <label for="setor">Setor</label>
            <input type="text" id="setor" name="setor" required>

            <label for="horario">Horário</label>
            <input type="datetime-local" id="horario" name="horario" required>

            <label for="codigoPostal">Código Postal</label>
            <input type="text" id="codigoPostal" name="codigoPostal" required>

            <label for="destinatario">Destinatário</label>
            <input type="text" id="destinatario" name="destinatario" required>

            <label for="servico">Serviço</label>
            <select id="servico" name="servico" required>
                <option value="SEDEX">SEDEX</option>
                <option value="PAC">PAC</option>
            </select>

            <button type="submit">Salvar</button>
        </form>
    </div>
						
						
						
						
						
						  
			    
<script>


        const addVisitBtn = document.getElementById('add-correios-btn');
        const sidebarRight = document.getElementById('sidebar-right');
        const closeSidebarBtn = document.getElementById('close-correios-btn');

     
        addVisitBtn.addEventListener('click', () => {
            sidebarRight.classList.add('active');
        });

       
        closeSidebarBtn.addEventListener('click', () => {
            sidebarRight.classList.remove('active');
        });

        document.getElementById('add-correios-btn').addEventListener('click', function() {
        var sidebarRight = document.getElementById('sidebar-Correios');
        sidebarRight.style.display = 'block'; 
    });
    document.getElementById('close-correios-btn').addEventListener('click', function() {
        var sidebarRight = document.getElementById('sidebar-Correios');
        sidebarRight.style.display = 'none'; 
    });



    function filter() {
        const input = document.getElementById('search-input');
        const filter = input.value.toLowerCase(); // Converte para minúsculas
        const table = document.querySelector('table');
        const rows = table.getElementsByTagName('tr');

        for (let i = 1; i < rows.length; i++) { // Começa na linha 1 para ignorar o cabeçalho
            const cells = rows[i].getElementsByTagName('td');
            let match = false;

            for (let j = 0; j < cells.length; j++) {
                if (cells[j].innerText.toLowerCase().indexOf(filter) > -1) {
                    match = true;
                    break;
                }
            }

            rows[i].style.display = match ? '' : 'none'; // Mostra ou oculta a linha
        }
    }

    function exportVisibleToCSV() {
    const rows = document.querySelectorAll("table tbody tr");
    let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
    csvContent += "ID;Funcionário;Setor;Horário;Código Postal;Destinatário;Serviço\n";

    rows.forEach(row => {
        if (row.style.display !== "none") { // Considera apenas linhas visíveis
            const cells = row.querySelectorAll("td");
            const id = cells[0].innerText;
            const funcionario = cells[1].innerText;
            const setor = cells[2].innerText;
            const horario = cells[3].innerText;
            const codigoPostal = cells[4].innerText;
            const destinatario = cells[5].innerText;
            const servico = cells[6].innerText;
            csvContent += `${id};${funcionario};${setor};${horario};${codigoPostal};${destinatario};${servico}\n`;
        }
    });

    if (csvContent.trim() === "data:text/csv;charset=utf-8,\uFEFF\nID;Funcionário;Setor;Horário;Código Postal;Destinatário;Serviço\n") {
        alert("Nenhum dado disponível para download.");
        return;
    }

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "dados_correios.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}


</script>

	</body>
    
</html>  